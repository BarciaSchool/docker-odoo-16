<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
	
	    <!--Supplier Partner Form-->
        <record id="straconx_purchase.view_res_supplier_partner_form_straconx" model="ir.ui.view">
            <field name="name">res.partner.supplier.form</field>
            <field name="model">res.partner</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            <form string="Suppliers" col="6">
                 <field name="vat" on_change="vat_change(vat)" required="True" default_focus="1" />
                 <field name="type_vat"/>                                  
                 <field name="origin" />
                 <newline/>
                 <field name="name" colspan="6" select="1"/>                 
                 <newline/>
                 <field name="property_payment_term_supplier" required="1"/>
                 <field name="property_account_position" required="1"/>
                 <field name="type_good"/>          
                 <newline/>
                 <field name="actcomercial" colspan="6"/>                 
                 <newline/>
                 <field name="capital"/>
                 <field name="patrimonio"/>
                 <field name="date"/>
                 <notebook colspan="6">
                    <page string="General">
                        <field name="address" mode="form,tree" colspan="4" nolabel="1" select="1" required="1">
                            <tree string="Addresses">
                                <field name="name"/>
                                <field name="type"/>
                                <field name="street"/>
                                <field name="phone"/>
                                <field name="email"/> 
                                <field name="location_id"/>                              
                            </tree>
                            <form string="Address">
                                <group colspan="4" col="6">
                                <field name="name"/>
                                    </group>
                                    <newline/>
                                      <group colspan="2" col="4">
                                        <separator string="Postal Address" colspan="4" col="4" />
                                        <field name="type" string="Type" colspan="2" required="1"/>
                                        <field name="street" colspan="4" required="1"/>
                                        <field name="location_id" colspan="4" required="1"/>
                                        <field name="buyer_assigned" colspan="4" />
                                        <field name="salesman_assigned" colspan="4" />
                                     </group>
                                     <group colspan="2" col="2">
                                        <separator string="Communication" colspan="2" col="2" />
                                        <field name="phone"/>
                                        <field name="phone2"/>
                                        <field name="mobile"/>
                                        <field name="fax"/>
                                        <field name="email" widget="email"/>
                                     </group>
                            <field name="contact_ids" mode="tree,form" nolabel="1" colspan="4"/>                            
                            </form>
                        </field>
                    </page>   
                    <page string="General Information">
                    <group col="4" colspan="4">
                        <separator string="Partner Status" colspan="4"/>
                            <group col="8" colspan="8">
                            <!--field name="customer"/-->
                            <field name="supplier"/>
							<field name="customer"/>
                            <field name="active"/>
                            <newline/>
                            <field name="permit_changed"/>
                            <field name="beneficiary"/>                            
                            </group>
                        <separator string="Comercial Information" colspan="4"/>
                            <field colspan="2" name="estado_id"/>
                            <field name="lang" required="True"/>
                            <separator string="Supplier Information" colspan="2"/>
                            <separator string="Customer Information" colspan="2"/>
                            <field name="property_product_pricelist_purchase" />
                            <field name="property_product_pricelist" readonly="1"/>
                            <field name="property_account_payable" readonly="0"/>
                            <field name="property_account_receivable" readonly="0"/>
                            <field name="payment_type_supplier" widget="selection"/>
                            <field name="payment_type_customer" widget="selection" readonly="1"/>                            
                    </group>
                    </page>
                    <page string="Account Banks and Credit Cards ">
                    <field colspan="4" context="{'address': address}" name="bank_ids" nolabel="1">
                        <form string="Bank account">
                            <field name="state"/>
                            <newline/>
                            <field name="acc_number" select="1"/>
                            <newline/>
                            <field name="bank"/>
                            <newline/>
                            <field name="sequence"/>
                            <field colspan="4" name="name"/>
                            <separator colspan="4" string="Bank account owner"/>
                            <field colspan="4" name="owner_name"/>
                            <field colspan="4" name="street"/>
                            <newline/>
                            <field name="zip"/>
                            <field name="city"/>
                            <newline/>
                            <field completion="1" name="country_id"/>
                            <field name="state_id"/>
                        </form>
                        <tree string="Bank Details">
                            <field name="state"/>
                            <field name="bank"/>
                            <field name="owner_name"/>
                            <field name="acc_number"/>
                        </tree>
                    </field>
                    </page>                        
                    <page string="Supplier History Notes">
                            <field name="credit_history_id" colspan="4" nolabel="1">
                            <tree string="Customer History" colors="red:state=='open';blue:state=='pending';gray:state=='cancel'">
                                 <field name="name"/>
                                 <field name="date_note"/>
                                 <field name="user_id"/>
                                 <field name="state"/>
                            </tree>
                            <form string="Customer History">
                                <group colspan="4" col="6">
                                     <field name="name"/>
                                     <field name="date_note"/>
                                     <newline/>
                                     <field name="message" colspan="4"/>
                                     <newline/>
                                     <field name="user_id"/>
                                     <field name="state"/>
                                 </group>
                            </form>
                        </field> 
                    </page>
                    <page string="Purchase History" position="inside">
                        <field name="emails" colspan="4" nolabel="1"/>
                        <field name="opportunity_ids" colspan="4" nolabel="1" context="{'default_partner_id': active_id}">
                             <tree string="Leads and Opportunities"  colors="blue:state=='pending';gray:state=='cancel'">
                                 <field name="create_date"/>
                                 <field name="name"/>
                                 <field name="type"/>
                                 <field name="stage_id"/>
                                 <button name="stage_previous" string="Previous"
                                     states="open,pending" type="object" icon="gtk-go-back" />
                                 <button name="stage_next" string="Next"
                                     states="open,pending" type="object"
                                     icon="gtk-go-forward" />
                                 <field name="user_id" />
                                 <field name="state" />
                                 <button name="case_cancel" string="Cancel"
                                     states="draft,open,pending" type="object"
                                     icon="gtk-cancel" />
                                 <button name="case_open" string="Open"
                                     states="draft,pending" type="object"
                                     icon="gtk-go-forward" />
                                 <button name="case_close" string="Close"
                                     states="open,draft,pending" type="object"
                                     icon="gtk-close" />
                                 <button string="Convert to Opportunity"
                                     name="convert_opportunity"
                                     states="draft,open,pending" icon="gtk-index"
                                     type="object" attrs="{'invisible':[('type','=','opportunity')]}" />
                                 <button name="case_escalate" string="Escalate"
                                     states="open,draft,pending" type="object"
                                     icon="gtk-go-up" />
                             </tree>
                        </field>
                        <field name="meeting_ids" colspan="4" nolabel="1"  context="{'default_partner_id': active_id}">
                            <tree string="Meetings" colors="gray:state in ('draft', 'cancel','done','pending')">
                                <field name="user_id" string="Responsible"/>
                                <field name="name" string="Subject" />
                                <field name="date" string="Start Date" />
                                <field name="date_deadline" string="End Date"/>
                            </tree>
                        </field>
                        <field name="phonecall_ids" colspan="4" nolabel="1" context="{'default_partner_id': active_id}">
                            <tree string="Phone Calls" colors="gray:state in ('draft', 'cancel','done','pending')">
                                <field name="date" string="Date"/>
                                <field name="name" string="Call Summary"/>
                                <field name="categ_id" string="Type" widget="selection"/>
                                <field name="user_id"/>
                                <field name="state"/>
                                <button name="case_cancel" string="Cancel" states="draft,open,pending" type="object" icon="gtk-cancel"/>
                                <button name="case_open" string="Open" states="draft,pending" type="object" icon="gtk-go-forward"/>
                                <button name="case_close" string="Held" states="open,draft,pending" type="object" icon="gtk-jump-to"/>
                                <button name="case_pending" string="Not Held" states="open" type="object" icon="gtk-media-pause"/>
                            </tree>
                            <form string="Phone Call">
                                 <group colspan="6" col="7">
                                    <field name="name" required="1"/>
                                    <field name="partner_phone"   attrs="{'required': [('categ_id.name', '=', 'Outbound')]}"/>
                                    <field name="duration" widget="float_time" required="1"/>
                                    <button string="Schedule a Meeting" name="action_make_meeting" icon="gtk-redo" type="object"/>

                                    <field name="date" required="1"/>
                                    <field name="user_id"/>
                                    <field name="section_id" colspan="1" widget="selection" />
                                    <button string="Convert to Opportunity"
                                        name="%(crm.phonecall2opportunity_act)d"
                                        icon="gtk-index" type="action"
                                        attrs="{'invisible':[('opportunity_id','!=',False)]}" />
                                    <label colspan="6"  string=""/>
                                    <button string="Schedule Other Call"
                                     icon="terp-call-start"
                                    name="%(crm.phonecall_to_phonecall_act)d"
                                    type="action"  />

                                </group>

                                <group col="3" colspan="2">
                                    <separator colspan="3" string="Contacts" />
                                    <field name="partner_id"
                                        on_change="onchange_partner_id(partner_id, email_from)" />
                                    <button string="Create a Partner"
                                        icon="terp-partner"
                                        name="%(crm.action_crm_phonecall2partner)d"
                                        type="action"
                                        attrs="{'invisible':[('partner_id','!=',False)]}"
                                        groups="base.group_partner_manager" />
                                    <newline/>
                                    <field name="partner_address_id"
                                        on_change="onchange_partner_address_id(partner_address_id, email_from)" />
                                    <newline/>
                                    <field name="partner_mobile" />
                                </group>
                                <group col="2" colspan="2">
                                    <separator colspan="2" string="Categorization" />
                                    <field name="categ_id" widget="selection"
                                        domain="[('object_id.model', '=', 'crm.phonecall')]"
                                        string="Type" />
                                    <field name="priority"/>
                                    <field name="opportunity_id"/>
                                </group>
                                <separator string="Description" colspan="4" />
                                <field name="description" nolabel="1" colspan="4" />
                                <separator colspan="4" />
                                <group col="8" colspan="4">
                                    <field name="state" select="1" />
                                    <button name="case_cancel" string="Cancel"
                                        states="draft,open,pending" type="object"
                                        icon="gtk-cancel" />
                                    <button name="case_open" string="Open"
                                        states="draft,pending" type="object"
                                        icon="gtk-go-forward" />
                                    <button name="case_pending" string="Not Held"
                                        states="open" type="object" icon="gtk-media-pause" />
                                    <button name="case_close" string="Held"
                                        states="open,draft,pending" type="object"
                                        icon="gtk-jump-to" />
                                    <button name="case_reset" string="Reset to Draft"
                                        states="done,cancel" type="object"
                                        icon="gtk-convert" />
                                </group>
                            </form>
                        </field>
                    </page>
                 </notebook>
            </form>
            </field>
        </record>

    
    <!--Supplier Partner Actions-->
	

		<record id="view_supplier_invoice_filter" model="ir.ui.view">
			<field name="name">Búsqueda de Facturas de Proveedor</field>
			<field name="model">account.invoice</field>
			<field name="type">search</field>
			<field name="arch" type="xml">
				<search string="Search Invoice">
					<group col="10" colspan="4">
						<filter string="Responsible" icon="terp-personal" domain="[]"
							context="{'group_by':'user_id'}" />
						<separator orientation="vertical" />
						<filter name="drafed" icon="terp-document-new" string="Draft"
							domain="[('state','=','draft')]" help="Draft Invoices" />
						<filter name="invoices" icon="terp-dolar" string="Invoices"
							domain="[('state','not in',['draft','cancel'])]" help="Proforma/Open/Paid Invoices" />
						<filter name="cancel" icon="gtk-cancel" string="Cancel"
							domain="[('state','=','cancel')]" help="Cancel Invoices" />
						<separator orientation="vertical" />
						<field name="invoice_number" />
						<field name="origin" />
						<field name="partner_id" />
						<field name="date_invoice" />
						<field name="state" />				
						<field name="amount_total" />
						<field name="origin_transaction" />						
					</group>
					<newline />
					<group expand="1">
						<field name="shop_id" widget="selection"/>								
						<field name="tpurchase"/>						
						<field name="period_id" string="Period" />
					</group>
					<newline />
					<group expand="0" string="More filters...">
						<filter name="unpaid" icon="terp-dolar_ok!" string="Unpaid"
							domain="[('state','=','open')]" help="Unpaid Invoices" />
						<filter name="actives" icon="terp-stock_format-default" string="Activas"
							domain="[('state','!=','cancel')]"/>
						<separator orientation="vertical" />
						<field name="user_id" string="Comprador" select="1" widget="selection">
							<filter domain="[('user_id','=',uid)]" help="My invoices"
								icon="terp-personal" separator="1" />
						</field>
						<field name="address_invoice_id" string="Dirección"/>
					</group>
					<newline />
					<group expand="0" string="Group By...">
						<filter string="Compañia" icon="terp-partner" domain="[]"
							context="{'group_by':'company_id'}" />
						<filter string="Partner" icon="terp-partner" domain="[]"
							context="{'group_by':'partner_id'}" />
						<separator orientation="vertical" />
						<filter string="Tipo de Compra" icon="terp-stock_format-default" domain="[]"
							context="{'group_by':'tpurchase'}" />
						<filter string="Origen" icon="terp-accessories-archiver"
							domain="[]" context="{'group_by':'origin_transaction'}" />
						<separator orientation="vertical" />
						<filter string="Journal" icon="terp-folder-orange" domain="[]"
							context="{'group_by':'journal_id'}" />
						<filter string="State" icon="terp-stock_effects-object-colorize"
							domain="[]" context="{'group_by':'state'}" />
						<separator orientation="vertical" />
						<filter string="Period" icon="terp-go-month" domain="[]"
							context="{'group_by':'period_id'}" />
						<filter string="Invoice Date" icon="terp-go-week" domain="[]"
							context="{'group_by':'date_invoice'}" />
						<filter string="Due Date" icon="terp-go-today" domain="[]"
							context="{'group_by':'date_due'}" />
					</group>
				</search>
			</field>
		</record>

		<record id="view_invoice_supplier_tree" model="ir.ui.view">
			<field name="name">account.invoice.supplier.tree</field>
			<field name="model">account.invoice</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree
					colors="blue:state == 'draft';black:state in ('proforma','proforma2','open');gray:state == 'cancel'"
					string="Invoice">
					<field name="date_invoice" />
					<field name="invoice_number_in" />
					<field name="partner_id"/>
					<field name="name" invisible="1" />
					<field name="segmento_id" invisible="1" />
					<field name="journal_id" invisible="1" />
					<field name="period_id" invisible="1" />
					<field name="company_id" invisible="1" />
					<field name="date_due" />
					<field name="origin" invisible="1" />					
					<field name="amount_untaxed" sum="Untaxed Amount" />
					<field name="amount_total_vat" sum="Taxes Vat Amount" />
					<field name="amount_total" sum="Total Amount" />
					<field name="residual" sum="Residual Amount" />
					<field name="user_id" string="Buyer" />
					<field name="state" />
				</tree>
			</field>
		</record>

		<record id="account.invoice_supplier_form" model="ir.ui.view">
			<field name="name">account.invoice.supplier.form</field>
			<field name="model">account.invoice</field>
			<field name="type">form</field>
			<field name="priority">2</field>
			<field name="arch" type="xml">
				<form string="Supplier Invoice">
					<group col="4" colspan="4">
						<field name="company_id" colspan="4"
							on_change="onchange_company_id(company_id,partner_id,type,invoice_line,date_invoice2,currency_id, context)"
							widget="selection" groups="base.group_multi_company" />					
						<newline />					
						<field name="shop_id" domain="[('company_id','=', company_id)]"
							on_change="onchange_shop(company_id, shop_id, type,context)"
							required="1" />
						<newline />
						<field string="Supplier" name="partner_id"
							domain="[('type_vat','not in',('ci','consumidor')),('supplier', '=', True)]"
							colspan="4"
							on_change="onchange_partner_id(type,partner_id,electronic,printer_id,date_invoice,payment_term, partner_bank_id,company_id)"
							context="{'default_customer': 0, 'search_default_supplier': 1, 'default_supplier': 1, 'form_view_ref':'straconx_purchase.view_res_supplier_partner_form_straconx'}"
							options="{&quot;quick_create&quot;: false}" />
						<newline />
						<field domain="[('partner_id','=',partner_id)]" name="address_invoice_id"
							context="{'default_partner_id': partner_id}" options="{&quot;quick_create&quot;: false}"
							colspan="4" />
						<newline />
						<field name="tpurchase"
						on_change="onchange_type_document(document_type, type, tpurchase, context)"
						required="1" />
						<field name="electronic" string="Documento Electrónico"/>
						<field name="date_invoice2"
							on_change="onchange_date2(date_invoice2,company_id,context)"
							context = "{'change_date':True, 'date_invoice':date_invoice}"
							required="1" invisible="1"/>
						<field name="date_invoice"
							on_change="onchange_date2(date_invoice2,company_id,context)"
							context = "{'change_date':True, 'date_invoice':date_invoice}"
							required="1" />
						<field name="date_due" />
						<newline />						
						<field name="invoice_number_in" required="1"/>
						<field name="authorization"
							attrs="{'required':[('electronic','=',True),('migrate','=',True)]}"/>
						<field name="access_key"
							attrs="{'invisible':[('electronic','!=',True)]}"
						/>
						<newline />
						<field name="payment_term" required="1" 
						options="{&quot;quick_create&quot;: false}"/>
						<field name="check_total" required="1" />
						<newline />
						<field
							domain="[('company_id', '=', company_id), ('type', '=', 'payable')]"
							name="account_id" groups="account.group_account_user" />
						<!-- <field name="type_change"/> -->
						<newline />
						<field name="printer_id" invisible="1" />
						<field name="migrate" invisible="1" />						
						<field name="description" colspan="4" required="1"/>						
					</group>
					<notebook colspan="4">
						<page string="Invoice">
							<field colspan="4"
								context="{'address_invoice_id': address_invoice_id, 'partner_id': partner_id, 'price_type': 'price_type' in dir() and price_type or False, 'type': type, 'tpurchase':tpurchase}"
								name="invoice_line" nolabel="1" on_change="onchange_line_ids(invoice_line)">
								<tree string="Invoice Line">
									<field name="sequence"
										on_change="sequence_change(parent.invoice_line, parent.shop_id)"
										invisible="1" />
									<field name="employee_id" invisible="1" />
									<field name="product_id"
										on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context ,parent.company_id, discount, offer, parent.shop_id)"
										context="{'form_view_ref':'straconx_products.product_sale_product_form_view','price_product': price_product,'invoice_line_tax_id': invoice_line_tax_id}"
										invisible="1" />
									<field colspan="4" name="name"
										on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id,context , parent.company_id,discount,offer, parent.shop_id)"										
										context="{'form_view_ref':'straconx_products.product_sale_product_form_view','price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
									<field
										domain="[('company_id', '=', parent.company_id), ('journal_id', '=', parent.journal_id), ('type', '&lt;&gt;', 'view')]"
										name="account_id" groups="analytic.group_analytic_accounting" required ="1"
										on_change="onchange_account_id(product_id,parent.partner_id,parent.type,parent.fiscal_position,account_id, name, parent.company_id, parent.shop_id, parent.currency_id)" />
									<field
										domain="[('type','&lt;&gt;','view'), ('company_id', '=', parent.company_id), ('parent_id', '!=', False)]"
										name="account_analytic_id" groups="analytic.group_analytic_accounting" />
									<field name="quantity"
										on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context ,parent.company_id, discount, offer, parent.shop_id)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
									<field name="uos_id"
										on_change="uos_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context ,parent.company_id, parent.shop_id)"
										context="{'form_view_ref':'straconx_products.product_sale_product_form_view','price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										nolabel="1" invisible="0" />
									<field name="price_iva" string="Precio incl. IVA"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'change_price_net':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										invisible="0" />
									<field name="price_product" string="Precio Bruto"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'change_price_product':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										invisible="0" />
									<field name="discount"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										invisible="0" readonly="0" />
									<field name="offer"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										invisible="0" />
									<field name="price_unit"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'change_price_product':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
									<field name="price_subtotal"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
									<field name="margin" invisible="1"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										groups="analytic.group_analytic_accounting" />
									<field name="iva_value"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										groups="analytic.group_analytic_accounting" />
									<field name="perception_value"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
										groups="analytic.group_analytic_accounting" />
									<field name="company_id" invisible="1" readonly="1" />
									<field name="invoice_line_tax_id"
										context="{'type':parent.type, 'invoice_line_tax_id': invoice_line_tax_id}"
										on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
										domain="[('parent_id','=',False),('company_id', '=', parent.company_id)]"
										invisible="1" nolabel="1" />
								</tree>
								<form string="Invoice Line">
									<notebook>
										<page string="Line">
											<field name="sequence"
												on_change="sequence_change(parent.invoice_line, parent.shop_id)"
												invisible="1" />
											<field name="product_id"
												on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context, parent.company_id, discount, offer, parent.shop_id)"
												invisible="0" />
											<field name="categ_id" />
											<field colspan="4" name="name" required="1" 
												on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id,context , parent.company_id,discount,offer, parent.shop_id)"										
												context="{'form_view_ref':'straconx_products.product_sale_product_form_view','price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
											<field
												domain="[('company_id', '=', parent.company_id), ('journal_id', '=', parent.journal_id), ('type', '&lt;&gt;', 'view')]"
												name="account_id"
												on_change="onchange_account_id(product_id,parent.partner_id,parent.type,parent.fiscal_position,account_id, name, parent.company_id, parent.shop_id, parent.currency_id)"
												required="1" />
											<field name="cost_journal" required="1"/>
											<field
												domain="[('type','&lt;&gt;','view'), ('company_id', '=', parent.company_id), ('parent_id', '!=', False)]"
												name="account_analytic_id"/>
											<field name="shop_id" required="1"/>
											<field name="department_id"  required="1"/>
											<field name="employee_id"
												on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id,context , parent.company_id,discount,offer, parent.shop_id)"										
												context="{'form_view_ref':'straconx_products.product_sale_product_form_view','price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
											
											<label string="Quantity :" align="1.0" />
											<group colspan="1" col="2">
												<field name="quantity" nolabel="1"
													on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context ,parent.company_id, discount, offer, parent.shop_id)" />
												<field name="uos_id"
													on_change="uos_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.address_invoice_id, parent.currency_id, context, parent.company_id)"
													nolabel="1" />
											</group>
											<field name="price_iva" string="Precio incl. IVA"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id, price_iva,parent.fiscal_position,context)"
												context="{'change_price_net':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												invisible="1"											
												/>
											<field name="price_product" string="Precio Bruto"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'change_price_product':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												/>
											<field name="discount"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												invisible="0" />
											<field name="offer"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												invisible="1"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
											<field name="price_unit"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'change_price_product':True,'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
											<field name="price_subtotal"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}" />
											<field name="margin"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												groups="analytic.group_analytic_accounting" />
											<field name="iva_value"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												/>
											<field name="perception_value"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												context="{'price_product': price_product, 'invoice_line_tax_id': invoice_line_tax_id}"
												/>
											<field name="company_id" groups="base.group_multi_company"
												readonly="1" />
											<newline/>
											<separator colspan="2" string="Taxes" />
											<field name="invoice_line_tax_id" colspan="4"
												context="{'type':parent.type, 'invoice_line_tax_id': invoice_line_tax_id}"
												on_change="onchange_offer(product_id, offer, quantity, price_unit,margin,price_product,discount,invoice_line_tax_id,price_iva,parent.fiscal_position,context)"
												domain="[('parent_id','=',False),('company_id', '=', parent.company_id)]"
												nolabel="1" />
										</page>
									</notebook>
								</form>
							</field>
							<group col="4" colspan="4">
								<group colspan="4" col="8">
									<group col="2" colspan="4">
										<field name="tax_line" nolabel="1">
											<tree editable="bottom" string="Taxes">
												<field name="name" />
												<field name="account_id" groups="account.group_account_invoice" />
												<field name="base"
													on_change="base_change(base,parent.currency_id,parent.company_id,parent.date_invoice)"
													readonly="1" />
												<field name="amount"
													on_change="amount_change(amount,parent.currency_id,parent.company_id,parent.date_invoice)" />
												<field invisible="True" name="base_amount" />
												<field invisible="True" name="tax_amount" />
												<field name="factor_base" invisible="True" />
												<field name="factor_tax" invisible="True" />
											</tree>
										</field>
									</group>
									<group col="2" colspan="4">
										<separator string="Invoice Information" colspan="8" />
										<field name="account_quantity" />
										<field name="pretotal" />
										<field name="amount_untaxed" />
										<field name="amount_total_vat" />
										<field name="amount_tax_other" />
										<field name="amount_total" />
										<field name="residual" />
									</group>										
								</group>
								<group colspan="5" col="10">
									<button name="%(invoice_supplier_report_id)d" string="Print Supplier Invoice"
										type="action" icon="gtk-print" states="open,paid" />
									<button name="action_open_draft" type='object' string='Modify'
										states='open' icon="gtk-convert" invisible="1"
										groups="account.group_account_invoice,purchase.group_purchase_user,purchase.group_purchase_mananager" />
									<button name="%(straconx_authorizations.action_auth)d" string="Reabrir Factura"
										type="action" icon="gtk-convert"
										attrs="{'invisible':[('state','in',[('draft'),('cancel')])]}"
										context="{'draft_invoice':True}"/>
									<button name="invoice_open" states="draft,proforma2"
										string="Approve" icon="terp-camera_test" />
								</group>
								<group colspan="5" col="10">
									<field name="state" />
										<button name="%(straconx_authorizations.action_auth)d" string="Anular la factura"
											type="action" icon="gtk-cancel"
											attrs="{'invisible':[('state','not in',[('paid'),('open')])]}"
											context="{'cancel_invoice':True}"
											confirm="¿Está seguro de anular la factura? Esto anulara la factura y todo los documentos relacionados."/>
										<button name="invoice_cancel" states="proforma2,draft"
											groups="account.group_account_invoice,purchase.group_purchase_user,purchase.group_purchase_mananager"
											string="Cancel All" icon="gtk-cancel"
											confirm="Are you sure to cancel this invoice with picking and order associated?" />
										<button name="action_cancel_draft" states="cancel"
											string="Set to Draft" type="object"
											groups="account.group_account_invoice,purchase.group_purchase_user,purchase.group_purchase_mananager"
											icon="terp-stock_effects-object-colorize" />
										<button name="button_reset_taxes" states="draft,proforma2"
											string="Compute Taxes" type="object"
											invisible="0" icon="terp-stock_format-scientific" help="This action will erase taxes" />
								</group>
							</group>
						</page>
						<page string="Tax Info">
							<group colspan="3" col="6">
								<separator string="Tax Information Withhold" colspan="6" />
								<newline />
								<field name="amount_tax_withhold_vat" />
								<field name="amount_tax_withhold" />
							</group>
							<newline />
						</page>
						<page string="Other Info">
							<separator colspan="4" string="Invoice Information" />
							<field name="name"/>
							<field name="origin_transaction" required="1" />
							<field name="country_id"
								attrs="{'required':[('origin_transaction','=','international')]}" />
							<field domain="[('partner_id', '=', partner_id)]" name="partner_bank_id"
								on_change="onchange_partner_bank(partner_bank_id)" />
							<field name="segmento_id" widget="selection"></field>
							<newline />
							<field name="journal_id" on_change="onchange_journal_id(journal_id,context)" />
							<field name="type" invisible="1" />
							<field name="currency_id" />
							<field name="fiscal_position" widget="selection" />
							<field name="period_id"
								domain="[('state', '=', 'draft'),('company_id','=',company_id)]"
								groups="account.group_account_manager" />
							<field name="origin" groups="base.group_extended" />
							<field domain="[('partner_id','=',partner_id)]" name="address_contact_id"
								groups="base.group_extended" />
							<newline />
							<field name="user_id" string="Buyer" />
							<field name="vat" />
							<field name="move_id"/>
							<field name="document_type" required="1"
								on_change="onchange_type_document(document_type, type, tpurchase, context)" />
							<field name="reconciled" invisible="1" />
							<separator colspan="4" string="Additional Information" />
							<field colspan="4" name="comment" nolabel="1" />
						</page>
						<page string="Payments">
							<field name="payment_ids" colspan="4" nolabel="1">
								<tree string="Payments">
									<field name="date" string="Payment Date" />
									<field name="ref" />
									<field name="name" groups="base.group_extended" />
									<field name="journal_id" />
									<field name="debit" />
									<field name="credit" />
									<field name="amount_currency" groups="base.group_extended" />
									<field name="currency_id" groups="base.group_extended" />
								</tree>
							</field>
						</page>
						<page string="Historial de Factura">
							<field name="history_document" readonly="1" nolabel="1"/>
						</page>
					</notebook>
				</form>
			</field>
		</record>

		<delete model="ir.ui.view"
			id="account_payment_extension.invoice_supplier_form2" />

		<!-- Modificacion de accion de facturas proveedores para que se muestren 
			al usuario vistas especificas -->
		<record id="account.action_invoice_tree2" model="ir.actions.act_window">
			<field name="name">Supplier Invoices</field>
			<field name="res_model">account.invoice</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form,calendar,graph</field>
			<field eval="False" name="view_id" />
			<field name="domain">[('type','=','in_invoice'),('journal_id.type','=','purchase')]</field>
			<field name="context">{'default_type':'in_invoice', 'type':'in_invoice', 'journal_type': 'purchase', 'search_default_draft': 1}</field>
			<field name="search_view_id" ref="view_supplier_invoice_filter" />
			<field name="help">With Supplier Invoices you can enter and manage
				invoices issued by your suppliers. OpenERP can also generate draft
				invoices automatically from purchase orders or receipts. This way,
				you can control the invoice from your supplier according to what you
				purchased or received.
			</field>
		</record>

		<record id="action_invoice_tree2_view1" model="ir.actions.act_window.view">
			<field eval="1" name="sequence" />
			<field name="view_mode">tree</field>
			<field name="view_id" ref="view_invoice_supplier_tree" />
			<field name="act_window_id" ref="account.action_invoice_tree2" />
		</record>

		<record id="action_invoice_tree2_view2" model="ir.actions.act_window.view">
			<field eval="2" name="sequence" />
			<field name="view_mode">form</field>
			<field name="view_id" ref="account.invoice_supplier_form" />
			<field name="act_window_id" ref="account.action_invoice_tree2" />
		</record>

		<record id="action_sale_note_purchase" model="ir.actions.act_window">
			<field name="name">Nota de Venta Proveedores</field>
			<field name="res_model">account.invoice</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form,calendar,graph</field>
			<field eval="False" name="view_id" />
			<field name="domain">[('type','=','in_invoice'),('journal_id.type','=','sale_note')]</field>
			<field name="context">{'default_type':'in_invoice', 'type':'in_invoice', 'journal_type': 'sale_note', 'search_default_draft': 1, 'document_type':'02'}</field>
			<field name="search_view_id" ref="view_supplier_invoice_filter" />
		</record>

		<record id="action_sale_note_purchase_view1" model="ir.actions.act_window.view">
			<field eval="1" name="sequence" />
			<field name="view_mode">tree</field>
			<field name="view_id" ref="view_invoice_supplier_tree" />
			<field name="act_window_id" ref="action_sale_note_purchase" />
		</record>

		<record id="action_sale_note_purchase_view2" model="ir.actions.act_window.view">
			<field eval="2" name="sequence" />
			<field name="view_mode">form</field>
			<field name="view_id" ref="account.invoice_supplier_form" />
			<field name="act_window_id" ref="action_sale_note_purchase" />
		</record>


	</data>
</openerp>
